<!DOCTYPE html>
<html>
<head>
    <title>Syntax Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Testing Key Functionality</h1>
    <div id="result"></div>
    <script>
        const resultDiv = document.getElementById('result');
        const tests = [];
        
        // Test 1: XLSX library loaded
        tests.push({
            name: 'SheetJS (XLSX) Library Loaded',
            pass: typeof XLSX !== 'undefined'
        });
        
        // Test 2: FileReader available
        tests.push({
            name: 'FileReader API Available',
            pass: typeof FileReader !== 'undefined'
        });
        
        // Test 3: Promise support
        tests.push({
            name: 'Promise Support',
            pass: typeof Promise !== 'undefined'
        });
        
        // Test 4: ArrayBuffer support
        tests.push({
            name: 'ArrayBuffer Support',
            pass: typeof Uint8Array !== 'undefined'
        });
        
        // Test 5: Test the parseCurrency function (inline version)
        const parseCurrency = (v) => {
            if (typeof v === 'number') return v;
            if (typeof v !== 'string') return 0;
            const c = v.replace(/[^0-9.-]+/g, "");
            const n = parseFloat(c);
            return isNaN(n) ? 0 : n;
        };
        tests.push({
            name: 'parseCurrency Function',
            pass: parseCurrency('Rs. 1,234.56') === 1234.56
        });
        
        // Display results
        let html = '<ul style="font-family: monospace;">';
        tests.forEach(test => {
            const icon = test.pass ? '✅' : '❌';
            const color = test.pass ? 'green' : 'red';
            html += `<li style="color: ${color}; margin: 10px 0;">${icon} ${test.name}</li>`;
        });
        html += '</ul>';
        
        const allPassed = tests.every(t => t.pass);
        html += `<h2 style="color: ${allPassed ? 'green' : 'red'};">`;
        html += allPassed ? '✅ All tests passed!' : '❌ Some tests failed';
        html += '</h2>';
        
        resultDiv.innerHTML = html;
        
        console.log('Test Results:', tests);
    </script>
</body>
</html>
